<!-- Merin Joseph
CPSC 597- Final project 
i-Grader 
CSUF - CS Grad-->

<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <title>i-Grader: Auto grader</title>

    <style>

      @font-face {
        font-family: 'Product Sans';
        font-style: normal;
        font-weight: 400;
        src: local('Open Sans'), local('OpenSans'), url(https://fonts.gstatic.com/s/productsans/v5/HYvgU2fE2nRJvZ5JFAumwegdm0LZdjqr5-oayXSOefg.woff2) format('woff2');
      }

      body{
        font-family: Product Sans;
        background-image: url('back_trial.jpg');
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-size: 100% 100%;
        padding-left: 60px;
      }

      h1{
        font-size: 50px;
        font-family: Product Sans;
        color: rgb(177, 10, 10);
      }

      textarea{
        padding: 20px;
        background-color: transparent;
        color: black;
        border-radius: 30px;
        outline: none;
      }


      h3{
        color: black;
        font-family: Product Sans;  
      }

  
      #logo-container {
          display: inline-block; 
          margin-right: 10px;
      }
    


    </style>
  </head>

  <body>
    <br><br>
    <div id="logo-container">
      <img src="bg_igrader.jpg" alt="Logo Alt Text" width="50" height="50"> 
    </div>
    <h1 >i-Grader</h1>
    <h1>AUTOMATED ESSAY SCORING</h1>
    <br>
    <div class="input-group">
        <textarea id="main" placeholder="Enter Essay Here" rows="11" cols="180"></textarea>
    </div>
    <br>

    <br>
    <button type="button" class="btn btn-outline-light" style="color: black; background-color: rgb(245, 233, 233)" onclick="senddata()">Score my Essay!</button>
    <br>
    <br>
    
    <h3 id="output">
    </h3>
    <div id="output" class="mt-4">

        <!-- Bootstrap Nav Tabs -->
        <ul class="nav nav-tabs" id="resultTabs">
            <li class="nav-item">
                <a class="nav-link active" id="lr-tab" data-toggle="tab" href="#lr-result">LR</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="svr-tab" data-toggle="tab" href="#svr-result">SVR</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="rf-tab" data-toggle="tab" href="#rf-result">RF</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="gpt-tab" data-toggle="tab" href="#gpt-result">GPT</a>
            </li>
        </ul>
    
        <!-- Bootstrap Tab Content -->
        <div class="tab-content">
            <div class="tab-pane fade show active" id="lr-result"></div>
            <div class="tab-pane fade" id="svr-result"></div>
            <div class="tab-pane fade" id="rf-result"></div>
            <div class="tab-pane fade" id="gpt-result"></div>
        </div>
    </div>
    
    <!-- Include Bootstrap JS and Popper.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    
    
    <script>
      function senddata() {
          var text = document.getElementById("main");
          var text_string = document.getElementById("main").value;
          if(text_string.trim()=="") {
            alert("Error: Please submit your essay inorder to score.");
          }
          else {
            var output = document.getElementById("output");
  
            const obj = {
                text: text.value
            };
    
            // LR
            fetch("http://localhost:5000/lr", {
                method: 'POST',
                body: JSON.stringify(obj),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(lrResult => {
                const lrResultDiv = document.createElement('div');
                lrResultDiv.innerHTML = lrResult && lrResult['Score using Linear Regression']
                    ? "LR Score: " + Math.abs(lrResult['Score using Linear Regression'][0]/100000).toFixed(3) + "/10<br>AI Detection using RoBERTa model: " + lrResult['AI Detection'] + "<br>"
                    : "LR Score: N/A<br>AI Detection: N/A<br>";
                //output.appendChild(lrResultDiv);
                document.getElementById("lr-result").innerHTML = lrResultDiv.innerHTML;
    
                // SVR
                fetch("http://localhost:5000/svr", {
                    method: 'POST',
                    body: JSON.stringify(obj),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(svrResult => {
                    const svrResultDiv = document.createElement('div');
                    svrResultDiv.innerHTML = svrResult
                        ? "SVR Score: " + svrResult['Score using SVR'][0]*10 + "/10<br>AI Detection using RoBERTa model: " + svrResult['AI Detection'] + "<br>"
                        : "SVR Score: N/A<br>AI Detection: N/A<br>";
                    //output.appendChild(svrResultDiv);
                    document.getElementById("svr-result").innerHTML = svrResultDiv.innerHTML;
    
                    // RF
                    fetch("http://localhost:5000/rf", {
                        method: 'POST',
                        body: JSON.stringify(obj),
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    })
                    .then(response => response.json())
                    .then(rfResult => {
                        const rfResultDiv = document.createElement('div');    
                        rfResultDiv.innerHTML = rfResult
                            ? "RF Score: " + rfResult['Score using Random Forest'] + "/10<br>AI Detection using RoBERTa model: " + rfResult['AI Detection'] + "<br>"
                            : "RF Score: N/A<br>AI Detection: N/A<br>";
                        //output.appendChild(rfResultDiv);
                        document.getElementById("rf-result").innerHTML = rfResultDiv.innerHTML;
    
                        fetch("http://localhost:5000/gpt", {
                            method: 'POST',
                            body: JSON.stringify(obj),
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        })
                        .then(response => response.text())  // Use response.text() for plain text
                        .then(gptResult => {
                            const gptResultDiv = document.createElement('div');
                            gptResultDiv.innerHTML = gptResult
                                ? "GPT Output: " + gptResult + "<br>"
                                : "GPT Output: N/A<br>";
                            //output.appendChild(gptResultDiv);
                            document.getElementById("gpt-result").innerHTML = gptResultDiv.innerHTML;
                        })
                        .catch(error => {
                            console.error('GPT Error:', error);
                        });
                
                    })
                    .catch(error => {
                        console.error('RF Error:', error);
                    });
                })
                .catch(error => {
                    console.error('SVR Error:', error);
                });
            })
            .catch(error => {
                console.error('LR Error:', error);
            });
        }
          }
          
    </script>


  </body>
</html>